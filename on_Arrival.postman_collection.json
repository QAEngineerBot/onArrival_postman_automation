{
	"info": {
		"_postman_id": "7e598b7f-67e2-4486-acb4-6ca380e4de63",
		"name": "on Arrival",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "25486917",
		"_collection_link": "https://lively-equinox-81665.postman.co/workspace/Testing~7e988f22-c450-4e12-8cd9-ff9521e31517/collection/25486917-7e598b7f-67e2-4486-acb4-6ca380e4de63?action=share&source=collection_link&creator=25486917"
	},
	"item": [
		{
			"name": "onarrival",
			"item": [
				{
					"name": "user login",
					"item": [
						{
							"name": "Request OTP",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"// Extract user_token from response and set as collection variable\r",
											"const jsonResponse = pm.response.json();\r",
											"\r",
											"if (jsonResponse && jsonResponse.otp) {\r",
											"    pm.collectionVariables.set(\"otp\", jsonResponse.otp);\r",
											"    console.log(\"otp has been set as a collection variable\");\r",
											"} else {\r",
											"    console.log(\"otp not found in response\");\r",
											"}"
										],
										"type": "text/javascript",
										"packages": {},
										"requests": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"mobile\": {{mobile}}\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/customer/v1/auth/request-otp",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"customer",
										"v1",
										"auth",
										"request-otp"
									]
								}
							},
							"response": [
								{
									"name": "Success",
									"originalRequest": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Accept",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"mobile\": 6666611111\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/customer/v1/auth/request-otp",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"v1",
												"auth",
												"request-otp"
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n  \"otp\": null\n}"
								}
							]
						},
						{
							"name": "Login the customer",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"// Extract user_token from response and set as collection variable",
											"const jsonResponse = pm.response.json();",
											"",
											"if (jsonResponse && jsonResponse.token) {",
											"    pm.collectionVariables.set(\"user_token\", jsonResponse.token);",
											"    console.log(\"user_token has been set as a collection variable\");",
											"} else {",
											"    console.log(\"user_token not found in response\");",
											"}"
										],
										"type": "text/javascript",
										"packages": {},
										"requests": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"mobile\": {{mobile}},\n  \"otp\": {{otp}}\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/customer/v1/auth/login",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"customer",
										"v1",
										"auth",
										"login"
									]
								}
							},
							"response": [
								{
									"name": "Success",
									"originalRequest": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Accept",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"mobile\": 6666611111,\n  \"otp\": 9970\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/customer/v1/auth/login",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"v1",
												"auth",
												"login"
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n  \"type\": \"bearer\",\n  \"token\": \"Nzg5Mg.3iyUEogkS4S64jWP1x0K7HOA-MMQhiAFNeVbQDwNFXqE1XhjINVhy5JdSwjr\"\n}"
								}
							]
						}
					]
				},
				{
					"name": "token",
					"item": [
						{
							"name": "Generate JWT token for OnArrival authentication",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"// Extract jwt token from response and set as collection variable\r",
											"const jsonResponse = pm.response.json();\r",
											"\r",
											"if (jsonResponse && jsonResponse.token) {\r",
											"    pm.collectionVariables.set(\"jwt_token\", jsonResponse.token);\r",
											"    console.log(\"jwt_token has been set as a collection variable\");\r",
											"} else {\r",
											"    console.log(\"jwt_token not found in response\");\r",
											"}\r",
											""
										],
										"type": "text/javascript",
										"packages": {},
										"requests": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{user_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{baseUrl}}/customer/v1/onarrival/token",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"customer",
										"v1",
										"onarrival",
										"token"
									]
								},
								"description": "Returns a JWT token that can be used to authenticate with OnArrival services. The token includes user ID, organization ID, and organization code."
							},
							"response": [
								{
									"name": "JWT token generated successfully",
									"originalRequest": {
										"method": "GET",
										"header": [
											{
												"key": "Accept",
												"value": "application/json"
											},
											{
												"key": "Authorization",
												"value": "Bearer <token>",
												"description": "Added as a part of security scheme: bearer"
											}
										],
										"url": {
											"raw": "{{baseUrl}}/customer/onarrival/v1/token",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"onarrival",
												"v1",
												"token"
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n  \"token\": \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"userId\": \"12345\",\n  \"organizationId\": \"org_123456\",\n  \"organizationCode\": \"ORG123\"\n}"
								},
								{
									"name": "Unauthorized - Authentication required",
									"originalRequest": {
										"method": "GET",
										"header": [
											{
												"key": "Authorization",
												"value": "Bearer <token>",
												"description": "Added as a part of security scheme: bearer"
											}
										],
										"url": {
											"raw": "{{baseUrl}}/customer/onarrival/v1/token",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"onarrival",
												"v1",
												"token"
											]
										}
									},
									"status": "Unauthorized",
									"code": 401,
									"_postman_previewlanguage": "text",
									"header": [],
									"cookie": [],
									"body": ""
								},
								{
									"name": "Unprocessable Entity - Mobile number not found",
									"originalRequest": {
										"method": "GET",
										"header": [
											{
												"key": "Authorization",
												"value": "Bearer <token>",
												"description": "Added as a part of security scheme: bearer"
											}
										],
										"url": {
											"raw": "{{baseUrl}}/customer/onarrival/v1/token",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"onarrival",
												"v1",
												"token"
											]
										}
									},
									"status": "Unprocessable Entity (WebDAV) (RFC 4918)",
									"code": 422,
									"_postman_previewlanguage": "text",
									"header": [],
									"cookie": [],
									"body": ""
								}
							]
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"packages": {},
								"requests": {},
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"packages": {},
								"requests": {},
								"exec": [
									""
								]
							}
						}
					]
				},
				{
					"name": "v1",
					"item": [
						{
							"name": "user profile",
							"item": [
								{
									"name": "Fetch user profile from OnArrival",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"// Parse response JSON",
													"const jsonData = pm.response.json();",
													"",
													"if (jsonData && jsonData.userId) {",
													"    pm.collectionVariables.set(\"novio_code\", jsonData.user.id);",
													"    console.log(\"novio_code has been set as a collection variable\");",
													"} else {",
													"    console.log(\"novio_code not found in response\");",
													"}",
													"",
													"// 1. Response status code is 200",
													"pm.test(\"Response status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});",
													"",
													"// 2. Response has valid JSON structure",
													"pm.test(\"Response has valid JSON structure\", function () {",
													"    pm.expect(jsonData).to.be.an('object');",
													"    pm.expect(jsonData).to.have.property('user');",
													"    pm.expect(jsonData).to.have.property('campaigns');",
													"});",
													"",
													"// 3. User object exists and contains required fields",
													"pm.test(\"User object exists and contains required fields\", function () {",
													"    pm.expect(jsonData.user).to.be.an('object');",
													"    pm.expect(jsonData.user).to.have.property('id');",
													"    pm.expect(jsonData.user).to.have.property('username');",
													"    pm.expect(jsonData.user).to.have.property('email');",
													"    pm.expect(jsonData.user).to.have.property('mobile');",
													"    pm.expect(jsonData.user).to.have.property('firstName');",
													"    pm.expect(jsonData.user).to.have.property('lastName');",
													"    pm.expect(jsonData.user).to.have.property('dateOfBirth');",
													"    pm.expect(jsonData.user).to.have.property('gender');",
													"    pm.expect(jsonData.user).to.have.property('tags');",
													"});",
													"",
													"// 4. Campaigns object exists with earnCampaign and discountCampaigns arrays",
													"pm.test(\"Campaigns object exists with earnCampaign and discountCampaigns arrays\", function () {",
													"    pm.expect(jsonData.campaigns).to.be.an('object');",
													"    pm.expect(jsonData.campaigns).to.have.property('earnCampaign');",
													"    pm.expect(jsonData.campaigns.earnCampaign).to.be.an('array');",
													"    pm.expect(jsonData.campaigns).to.have.property('discountCampaigns');",
													"    pm.expect(jsonData.campaigns.discountCampaigns).to.be.an('array');",
													"});",
													"",
													"// 5. Each campaign in earnCampaign array has required fields",
													"pm.test(\"Each earnCampaign has required fields with correct types\", function () {",
													"    jsonData.campaigns.earnCampaign.forEach(function (campaign, index) {",
													"        pm.expect(campaign, `earnCampaign[${index}]`).to.have.property('type');",
													"        pm.expect(campaign.type).to.be.a('string');",
													"        pm.expect(campaign, `earnCampaign[${index}]`).to.have.property('offerType');",
													"        pm.expect(campaign.offerType).to.be.a('string');",
													"        pm.expect(campaign, `earnCampaign[${index}]`).to.have.property('campaignName');",
													"        pm.expect(campaign.campaignName).to.be.a('string');",
													"        pm.expect(campaign, `earnCampaign[${index}]`).to.have.property('displayMessage');",
													"        pm.expect(campaign.displayMessage).to.be.a('string');",
													"        pm.expect(campaign, `earnCampaign[${index}]`).to.have.property('percentagePerBooking');",
													"        pm.expect(campaign.percentagePerBooking).to.be.a('number');",
													"        pm.expect(campaign, `earnCampaign[${index}]`).to.have.property('isVisible');",
													"        pm.expect(campaign.isVisible).to.be.a('boolean');",
													"        pm.expect(campaign, `earnCampaign[${index}]`).to.have.property('order');",
													"        pm.expect(campaign.order).to.be.a('number');",
													"    });",
													"});",
													"",
													"// 6. Each campaign in discountCampaigns array has required fields",
													"pm.test(\"Each discountCampaign has required fields with correct types\", function () {",
													"    jsonData.campaigns.discountCampaigns.forEach(function (campaign, index) {",
													"        pm.expect(campaign, `discountCampaign[${index}]`).to.have.property('offerId');",
													"        pm.expect(campaign.offerId).to.be.a('string');",
													"        pm.expect(campaign, `discountCampaign[${index}]`).to.have.property('type');",
													"        pm.expect(campaign.type).to.be.a('string');",
													"        pm.expect(campaign, `discountCampaign[${index}]`).to.have.property('offerType');",
													"        pm.expect(campaign.offerType).to.be.a('string');",
													"        pm.expect(campaign, `discountCampaign[${index}]`).to.have.property('percentagePerBooking');",
													"        pm.expect(campaign.percentagePerBooking).to.be.a('number');",
													"        pm.expect(campaign, `discountCampaign[${index}]`).to.have.property('displayMessage');",
													"        pm.expect(campaign.displayMessage).to.be.a('string');",
													"        pm.expect(campaign, `discountCampaign[${index}]`).to.have.property('order');",
													"        pm.expect(campaign.order).to.be.a('number');",
													"        pm.expect(campaign, `discountCampaign[${index}]`).to.have.property('applicableEntity');",
													"        pm.expect(campaign.applicableEntity).to.be.an('array');",
													"    });",
													"});",
													"",
													"// 7. burnConfig object exists with required fields (nested inside campaigns)",
													"pm.test(\"burnConfig object exists with required fields\", function () {",
													"    pm.expect(jsonData.campaigns).to.have.property('burnConfig');",
													"    pm.expect(jsonData.campaigns.burnConfig).to.be.an('object');",
													"    pm.expect(jsonData.campaigns.burnConfig).to.have.property('coinsBalance');",
													"    pm.expect(jsonData.campaigns.burnConfig.coinsBalance).to.be.a('number');",
													"    pm.expect(jsonData.campaigns.burnConfig).to.have.property('convertionPerInrValue');",
													"    pm.expect(jsonData.campaigns.burnConfig.convertionPerInrValue).to.be.a('number');",
													"    pm.expect(jsonData.campaigns.burnConfig).to.have.property('maxBurnPercentagePerBooking');",
													"    pm.expect(jsonData.campaigns.burnConfig.maxBurnPercentagePerBooking).to.be.a('number');",
													"});"
												],
												"type": "text/javascript",
												"packages": {},
												"requests": {}
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "Accept",
												"value": "application/json"
											}
										],
										"url": {
											"raw": "{{baseUrl}}/onarrival/v1/user/profile",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"onarrival",
												"v1",
												"user",
												"profile"
											]
										},
										"description": "Retrieves user profile data from OnArrival including applicable campaigns, burn configuration, and convenience fee configuration. Updates local customer profile with OnArrival data."
									},
									"response": [
										{
											"name": "User profile retrieved successfully",
											"originalRequest": {
												"method": "GET",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "Authorization",
														"value": "Bearer <token>",
														"description": "Added as a part of security scheme: bearer"
													}
												],
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/user/profile",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"user",
														"profile"
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n  \"profile\": {\n    \"userId\": \"user_12345\",\n    \"email\": \"user@example.com\",\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"dateOfBirth\": \"1990-01-15\",\n    \"nationality\": \"IN\",\n    \"passportNumber\": \"AB1234567\",\n    \"passportExpiry\": \"2025-12-31\",\n    \"userTags\": [\n      \"FREQUENT_FLYER\",\n      \"PREMIUM\"\n    ]\n  },\n  \"campaigns\": [\n    {\n      \"campaignId\": \"camp_001\",\n      \"campaignName\": \"New Year Special\",\n      \"maxBurnPercentage\": 70,\n      \"conversionRate\": 0.25\n    },\n    {\n      \"campaignId\": \"camp_001\",\n      \"campaignName\": \"New Year Special\",\n      \"maxBurnPercentage\": 70,\n      \"conversionRate\": 0.25\n    }\n  ],\n  \"convenienceFeeConfig\": [\n    {\n      \"isInternational\": false,\n      \"tripType\": \"ROUND_TRIP\",\n      \"priceRange\": {\n        \"min\": 0,\n        \"max\": 5000\n      },\n      \"fee\": 150\n    },\n    {\n      \"isInternational\": false,\n      \"tripType\": \"ROUND_TRIP\",\n      \"priceRange\": {\n        \"min\": 0,\n        \"max\": 5000\n      },\n      \"fee\": 150\n    }\n  ]\n}"
										},
										{
											"name": "Unauthorized - Valid OnArrival JWT required",
											"originalRequest": {
												"method": "GET",
												"header": [
													{
														"key": "Authorization",
														"value": "Bearer <token>",
														"description": "Added as a part of security scheme: bearer"
													}
												],
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/user/profile",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"user",
														"profile"
													]
												}
											},
											"status": "Unauthorized",
											"code": 401,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										},
										{
											"name": "Unprocessable Entity - Failed to fetch profile",
											"originalRequest": {
												"method": "GET",
												"header": [
													{
														"key": "Authorization",
														"value": "Bearer <token>",
														"description": "Added as a part of security scheme: bearer"
													}
												],
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/user/profile",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"user",
														"profile"
													]
												}
											},
											"status": "Unprocessable Entity (WebDAV) (RFC 4918)",
											"code": 422,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										}
									]
								}
							]
						},
						{
							"name": "validate-redemption",
							"item": [
								{
									"name": "Validate coin redemption for a booking",
									"request": {
										"auth": {
											"type": "apikey",
											"apikey": [
												{
													"key": "key",
													"value": "X-API-KEY",
													"type": "string"
												},
												{
													"key": "value",
													"value": "{{apiKey}}",
													"type": "string"
												},
												{
													"key": "in",
													"value": "header",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Accept",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"coinsToRedeem\": 5000,\n  \"bookingAmount\": 10000,\n  \"maxBurnPercentage\": 70,\n  \"conversionRate\": 0.25,\n  \"availableCoins\": 8000\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/onarrival/v1/validate-redemption",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"onarrival",
												"v1",
												"validate-redemption"
											]
										},
										"description": "Validates if the requested coin redemption amount is valid based on available coins, booking amount, burn percentage limits, and conversion rate."
									},
									"response": [
										{
											"name": "Validation completed successfully",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "X-API-KEY",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"coinsToRedeem\": 5000,\n  \"bookingAmount\": 10000,\n  \"maxBurnPercentage\": 70,\n  \"conversionRate\": 0.25,\n  \"availableCoins\": 8000\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/validate-redemption",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"validate-redemption"
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n  \"success\": true,\n  \"data\": {\n    \"isValid\": true,\n    \"coinsToRedeem\": 5000,\n    \"redemptionValue\": 1250,\n    \"remainingAmount\": 8750,\n    \"maxAllowedRedemption\": 7000\n  }\n}"
										},
										{
											"name": "Bad request - Validation errors in request body",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "X-API-KEY",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"coinsToRedeem\": 5000,\n  \"bookingAmount\": 10000,\n  \"maxBurnPercentage\": 70,\n  \"conversionRate\": 0.25,\n  \"availableCoins\": 8000\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/validate-redemption",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"validate-redemption"
													]
												}
											},
											"status": "Bad Request",
											"code": 400,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										},
										{
											"name": "Unauthorized - Valid OnArrival JWT required",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "X-API-KEY",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"coinsToRedeem\": 5000,\n  \"bookingAmount\": 10000,\n  \"maxBurnPercentage\": 70,\n  \"conversionRate\": 0.25,\n  \"availableCoins\": 8000\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/validate-redemption",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"validate-redemption"
													]
												}
											},
											"status": "Unauthorized",
											"code": 401,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										},
										{
											"name": "Unprocessable Entity",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "X-API-KEY",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"coinsToRedeem\": 5000,\n  \"bookingAmount\": 10000,\n  \"maxBurnPercentage\": 70,\n  \"conversionRate\": 0.25,\n  \"availableCoins\": 8000\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/validate-redemption",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"validate-redemption"
													]
												}
											},
											"status": "Unprocessable Entity (WebDAV) (RFC 4918)",
											"code": 422,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										}
									]
								}
							]
						},
						{
							"name": "payment",
							"item": [
								{
									"name": "init",
									"item": [
										{
											"name": "Initiate flight booking payment",
											"event": [
												{
													"listen": "test",
													"script": {
														"exec": [
															"// ============================================",
															"// INITIATE FLIGHT BOOKING PAYMENT - TEST SUITE",
															"// ============================================",
															"// Critical payment initiation endpoint tests",
															"// Covers: Status, Structure, Fields, Business Logic, Data Types",
															"",
															"const jsonData = pm.response.json();",
															"const requestBody = JSON.parse(pm.request.body.raw);",
															"",
															"if (jsonData && jsonData.paymentId) {",
															"    pm.collectionVariables.set(\"payment_id\", jsonData.paymentId);",
															"    console.log(\"payment id has been set as a collection variable\");",
															"} else {",
															"    console.log(\"payment id not found in response\");",
															"}",
															"",
															"// ============================================",
															"// 1. RESPONSE STATUS & STRUCTURE TESTS",
															"// ============================================",
															"",
															"pm.test(\"1. Response status code is 200 for successful payment initiation\", function () {",
															"    pm.response.to.have.status(200);",
															"});",
															"",
															"pm.test(\"2. Response time is under 3000ms for payment operations\", function () {",
															"    pm.expect(pm.response.responseTime).to.be.below(3000);",
															"});",
															"",
															"pm.test(\"3. Response has valid JSON structure\", function () {",
															"    pm.response.to.be.json;",
															"    pm.expect(jsonData).to.be.an('object');",
															"});",
															"",
															"pm.test(\"4. Response contains all required top-level fields\", function () {",
															"    pm.expect(jsonData).to.have.property('paymentId');",
															"    pm.expect(jsonData).to.have.property('orderId');",
															"    pm.expect(jsonData).to.have.property('transactionId');",
															"    pm.expect(jsonData).to.have.property('amountInCash');",
															"    pm.expect(jsonData).to.have.property('amountInCoins');",
															"    pm.expect(jsonData).to.have.property('coinsRedeemed');",
															"    pm.expect(jsonData).to.have.property('totalAmount');",
															"    pm.expect(jsonData).to.have.property('paymentGatewayMetaInfo');",
															"    pm.expect(jsonData).to.have.property('createdAt');",
															"});",
															"",
															"// ============================================",
															"// 2. REQUIRED FIELDS VALIDATION TESTS",
															"// ============================================",
															"",
															"pm.test(\"5. paymentId exists and is a number (unique identifier)\", function () {",
															"    pm.expect(jsonData.paymentId).to.exist;",
															"    pm.expect(jsonData.paymentId).to.be.a('number');",
															"});",
															"",
															"pm.test(\"6. orderId exists and matches the request orderId\", function () {",
															"    pm.expect(jsonData.orderId).to.exist;",
															"    pm.expect(jsonData.orderId).to.eql(requestBody.orderId);",
															"});",
															"",
															"pm.test(\"7. transactionId exists and matches the request transactionId\", function () {",
															"    pm.expect(jsonData.transactionId).to.exist;",
															"    pm.expect(jsonData.transactionId).to.eql(requestBody.transactionId);",
															"});",
															"",
															"pm.test(\"8. amountInCash exists and matches the request value\", function () {",
															"    pm.expect(jsonData.amountInCash).to.exist;",
															"    pm.expect(jsonData.amountInCash).to.eql(requestBody.amountInCash);",
															"});",
															"",
															"pm.test(\"9. amountInCoins equals coinsRedeemed divided by 5 (business rule: 1 coin = 5 units)\", function () {",
															"    pm.expect(jsonData.amountInCoins).to.exist;",
															"    pm.expect(jsonData.amountInCoins).to.eql(requestBody.coinsRedeemed / 5);",
															"});",
															"",
															"pm.test(\"10. coinsRedeemed exists and matches the request value\", function () {",
															"    pm.expect(jsonData.coinsRedeemed).to.exist;",
															"    pm.expect(jsonData.coinsRedeemed).to.eql(requestBody.coinsRedeemed);",
															"});",
															"",
															"pm.test(\"11. totalAmount exists and matches the request value\", function () {",
															"    pm.expect(jsonData.totalAmount).to.exist;",
															"    pm.expect(jsonData.totalAmount).to.eql(requestBody.totalAmount);",
															"});",
															"",
															"pm.test(\"12. totalAmount equals sum of amountInCoins and amountInCash (business rule validation)\", function () {",
															"    const expectedTotalAmount = jsonData.amountInCoins + jsonData.amountInCash;",
															"    pm.expect(jsonData.totalAmount).to.eql(expectedTotalAmount);",
															"});",
															"",
															"pm.test(\"13. paymentGatewayMetaInfo object exists\", function () {",
															"    pm.expect(jsonData.paymentGatewayMetaInfo).to.exist;",
															"    pm.expect(jsonData.paymentGatewayMetaInfo).to.be.an('object');",
															"});",
															"",
															"pm.test(\"14. createdAt exists and is a valid timestamp\", function () {",
															"    pm.expect(jsonData.createdAt).to.exist;",
															"    pm.expect(jsonData.createdAt).to.be.a('string');",
															"    pm.expect(new Date(jsonData.createdAt).toString()).to.not.eql('Invalid Date');",
															"});",
															"",
															"pm.test(\"15. paymentGatewayMetaInfo.gatewayOrderId exists and is a string\", function () {",
															"    pm.expect(jsonData.paymentGatewayMetaInfo.gatewayOrderId).to.exist;",
															"    pm.expect(jsonData.paymentGatewayMetaInfo.gatewayOrderId).to.be.a('string');",
															"});",
															"",
															"pm.test(\"16. paymentGatewayMetaInfo.gatewayTransactionId exists and is a number\", function () {",
															"    pm.expect(jsonData.paymentGatewayMetaInfo.gatewayTransactionId).to.exist;",
															"    pm.expect(jsonData.paymentGatewayMetaInfo.gatewayTransactionId).to.be.a('number');",
															"});"
														],
														"type": "text/javascript",
														"packages": {},
														"requests": {}
													}
												}
											],
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "Accept",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"amountInCash\": 8000,\n  \"amountInCoins\": 1,\n  \"coinsRedeemed\": 5,\n  \"totalAmount\": 8001,\n  \"orderId\": \"ORD123456789\",\n  \"timeoutInSeconds\": 300,\n  \"userId\": \"USER123456\",\n  \"transactionId\": \"TXN987654321\",\n  \"dateOfTravel\": \"2025-03-13T14:29:30+00:00\",\n  \"metaInfo\": {\n    \"entityName\": \"FLIGHT\",\n    \"paymentMethod\": \"CARD\",\n    \"deviceType\": \"MOBILE\",\n    \"returnUrl\": \"https://partner.app/pay/callback\",\n    \"customerPhone\": \"+1234567890\"\n  }\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/payment/init",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"payment",
														"init"
													]
												},
												"description": "Initiates payment for a flight booking. This endpoint:\n- Validates the payment amounts (total = cash + coins)\n- HOLDs coins if being redeemed\n- Creates booking transaction record (immutable after success)\n- Creates transaction breakups for transparency\n- Initiates Airpay payment if cash amount > 0\n- Returns payment data for completing the payment\n\n**Critical**: Coins go through HOLD state and are converted to SPENT only after successful payment callback.\n"
											},
											"response": [
												{
													"name": "Payment initiated successfully",
													"originalRequest": {
														"method": "POST",
														"header": [
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Authorization",
																"value": "Bearer <token>",
																"description": "Added as a part of security scheme: bearer"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"amountInCash\": 8000,\n  \"amountInCoins\": 500,\n  \"coinsRedeemed\": 2000,\n  \"totalAmount\": 8500,\n  \"orderId\": \"ORD123456789\",\n  \"timeoutInSeconds\": 300,\n  \"userId\": \"USER123456\",\n  \"transactionId\": \"TXN987654321\",\n  \"dateOfTravel\": \"2025-03-13T14:29:30+00:00\",\n  \"metaInfo\": {\n    \"entityName\": \"FLIGHT\",\n    \"paymentMethod\": \"CARD\",\n    \"deviceType\": \"MOBILE\",\n    \"returnUrl\": \"https://partner.app/pay/callback\",\n    \"customerPhone\": \"+1234567890\"\n  }\n}",
															"options": {
																"raw": {
																	"headerFamily": "json",
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/payment/init",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"payment",
																"init"
															]
														}
													},
													"status": "OK",
													"code": 200,
													"_postman_previewlanguage": "json",
													"header": [
														{
															"key": "Content-Type",
															"value": "application/json"
														}
													],
													"cookie": [],
													"body": "{\n  \"paymentId\": 12345,\n  \"orderId\": \"ORD123456789\",\n  \"transactionId\": \"TXN987654321\",\n  \"paymentGatewayMetaInfo\": {\n    \"gatewayReferenceId\": \"AIRPAY_ORD_123456\",\n    \"gatewayTransactionId\": 98765\n  },\n  \"amountInCash\": 8000,\n  \"amountInCoins\": 500,\n  \"coinsRedeemed\": 2000,\n  \"totalAmount\": 8500,\n  \"createdAt\": \"2026-01-05T10:30:00.000Z\"\n}"
												},
												{
													"name": "Bad request - Validation errors in request body",
													"originalRequest": {
														"method": "POST",
														"header": [
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "Authorization",
																"value": "Bearer <token>",
																"description": "Added as a part of security scheme: bearer"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"amountInCash\": 8000,\n  \"amountInCoins\": 500,\n  \"coinsRedeemed\": 2000,\n  \"totalAmount\": 8500,\n  \"orderId\": \"ORD123456789\",\n  \"timeoutInSeconds\": 300,\n  \"userId\": \"USER123456\",\n  \"transactionId\": \"TXN987654321\",\n  \"dateOfTravel\": \"2025-03-13T14:29:30+00:00\",\n  \"metaInfo\": {\n    \"entityName\": \"FLIGHT\",\n    \"paymentMethod\": \"CARD\",\n    \"deviceType\": \"MOBILE\",\n    \"returnUrl\": \"https://partner.app/pay/callback\",\n    \"customerPhone\": \"+1234567890\"\n  }\n}",
															"options": {
																"raw": {
																	"headerFamily": "json",
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/payment/init",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"payment",
																"init"
															]
														}
													},
													"status": "Bad Request",
													"code": 400,
													"_postman_previewlanguage": "text",
													"header": [],
													"cookie": [],
													"body": ""
												},
												{
													"name": "Unauthorized - Valid OnArrival JWT required",
													"originalRequest": {
														"method": "POST",
														"header": [
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "Authorization",
																"value": "Bearer <token>",
																"description": "Added as a part of security scheme: bearer"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"amountInCash\": 8000,\n  \"amountInCoins\": 500,\n  \"coinsRedeemed\": 2000,\n  \"totalAmount\": 8500,\n  \"orderId\": \"ORD123456789\",\n  \"timeoutInSeconds\": 300,\n  \"userId\": \"USER123456\",\n  \"transactionId\": \"TXN987654321\",\n  \"dateOfTravel\": \"2025-03-13T14:29:30+00:00\",\n  \"metaInfo\": {\n    \"entityName\": \"FLIGHT\",\n    \"paymentMethod\": \"CARD\",\n    \"deviceType\": \"MOBILE\",\n    \"returnUrl\": \"https://partner.app/pay/callback\",\n    \"customerPhone\": \"+1234567890\"\n  }\n}",
															"options": {
																"raw": {
																	"headerFamily": "json",
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/payment/init",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"payment",
																"init"
															]
														}
													},
													"status": "Unauthorized",
													"code": 401,
													"_postman_previewlanguage": "text",
													"header": [],
													"cookie": [],
													"body": ""
												},
												{
													"name": "Unprocessable Entity - Invalid amounts, insufficient coins, or other business logic errors",
													"originalRequest": {
														"method": "POST",
														"header": [
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Authorization",
																"value": "Bearer <token>",
																"description": "Added as a part of security scheme: bearer"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"amountInCash\": 8000,\n  \"amountInCoins\": 500,\n  \"coinsRedeemed\": 2000,\n  \"totalAmount\": 8500,\n  \"orderId\": \"ORD123456789\",\n  \"timeoutInSeconds\": 300,\n  \"userId\": \"USER123456\",\n  \"transactionId\": \"TXN987654321\",\n  \"dateOfTravel\": \"2025-03-13T14:29:30+00:00\",\n  \"metaInfo\": {\n    \"entityName\": \"FLIGHT\",\n    \"paymentMethod\": \"CARD\",\n    \"deviceType\": \"MOBILE\",\n    \"returnUrl\": \"https://partner.app/pay/callback\",\n    \"customerPhone\": \"+1234567890\"\n  }\n}",
															"options": {
																"raw": {
																	"headerFamily": "json",
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/payment/init",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"payment",
																"init"
															]
														}
													},
													"status": "Unprocessable Entity (WebDAV) (RFC 4918)",
													"code": 422,
													"_postman_previewlanguage": "json",
													"header": [
														{
															"key": "Content-Type",
															"value": "application/json"
														}
													],
													"cookie": [],
													"body": "{\n  \"success\": false,\n  \"message\": \"Total amount must equal sum of cash and coins amount\"\n}"
												}
											]
										}
									]
								},
								{
									"name": "status",
									"item": [
										{
											"name": "Get payment and booking status",
											"request": {
												"auth": {
													"type": "apikey",
													"apikey": [
														{
															"key": "key",
															"value": "X-API-KEY",
															"type": "string"
														},
														{
															"key": "value",
															"value": "{{apiKey}}",
															"type": "string"
														},
														{
															"key": "in",
															"value": "header",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													}
												],
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/payment/status?paymentId={{payment_id}}",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"payment",
														"status"
													],
													"query": [
														{
															"key": "paymentId",
															"value": "{{payment_id}}",
															"description": "Payment ID (booking transaction ID)"
														}
													]
												},
												"description": "Retrieves the current status of a payment and associated booking.\n\n**Transaction Status:**\n- INITIATED - Payment initiated but not completed\n- PROCESSING - Payment is being processed\n- SUCCESS - Payment completed successfully (coins converted from HOLD to SPENT)\n- FAILED - Payment failed (HOLD coins released back to BALANCE)\n- CANCELLED - Payment cancelled (HOLD coins released)\n- REFUND_INITIATED - Refund process started\n- REFUNDED - Full refund completed (coins reverted from SPENT to BALANCE)\n\n**Booking Status:**\n- PENDING - Awaiting payment\n- CONFIRMED - Booking confirmed after successful payment\n- CANCELLED - Booking cancelled\n- COMPLETED - Journey completed\n"
											},
											"response": [
												{
													"name": "Status retrieved successfully",
													"originalRequest": {
														"method": "GET",
														"header": [
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "X-API-KEY",
																"value": "<API Key>",
																"description": "Added as a part of security scheme: apikey"
															}
														],
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/payment/status?paymentId=12345",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"payment",
																"status"
															],
															"query": [
																{
																	"key": "paymentId",
																	"value": "12345",
																	"description": "Payment ID (booking transaction ID)"
																}
															]
														}
													},
													"status": "OK",
													"code": 200,
													"_postman_previewlanguage": "json",
													"header": [
														{
															"key": "Content-Type",
															"value": "application/json"
														}
													],
													"cookie": [],
													"body": "{\n  \"transactionId\": \"12345\",\n  \"paymentId\": \"12345\",\n  \"amountInCash\": 8000,\n  \"amountInCoins\": 500,\n  \"totalAmount\": 8500,\n  \"coinRedeemed\": 2000,\n  \"status\": \"PAYMENT_SUCCESSFUL\",\n  \"paymentGateway\": \"AIRPAY\",\n  \"paymentMode\": \"UPI\",\n  \"userId\": \"12345\",\n  \"payeeId\": \"ORD123456789\",\n  \"currency\": \"INR\",\n  \"payedAt\": \"2026-01-05T10:35:00.000Z\",\n  \"createdAt\": \"2026-01-05T10:30:00.000Z\",\n  \"gatewayResponseCode\": \"SUCCESS\",\n  \"utr\": \"CRED1704634200ORD789\",\n  \"rrn\": \"206101234567\",\n  \"metadata\": {\n    \"deviceId\": \"device_123\",\n    \"ipAddress\": \"192.168.1.1\",\n    \"userAgent\": \"Mozilla/5.0...\",\n    \"transactionStatus\": \"SUCCESS\",\n    \"bookingStatus\": \"CONFIRMED\",\n    \"airpayStatus\": \"SUCCESS\"\n  }\n}"
												},
												{
													"name": "Unauthorized - Valid OnArrival JWT required",
													"originalRequest": {
														"method": "GET",
														"header": [
															{
																"key": "X-API-KEY",
																"value": "<API Key>",
																"description": "Added as a part of security scheme: apikey"
															}
														],
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/payment/status?paymentId=12345",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"payment",
																"status"
															],
															"query": [
																{
																	"key": "paymentId",
																	"value": "12345",
																	"description": "Payment ID (booking transaction ID)"
																}
															]
														}
													},
													"status": "Unauthorized",
													"code": 401,
													"_postman_previewlanguage": "text",
													"header": [],
													"cookie": [],
													"body": ""
												},
												{
													"name": "Not found - Transaction ID does not exist",
													"originalRequest": {
														"method": "GET",
														"header": [
															{
																"key": "X-API-KEY",
																"value": "<API Key>",
																"description": "Added as a part of security scheme: apikey"
															}
														],
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/payment/status?paymentId=12345",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"payment",
																"status"
															],
															"query": [
																{
																	"key": "paymentId",
																	"value": "12345",
																	"description": "Payment ID (booking transaction ID)"
																}
															]
														}
													},
													"status": "Not Found",
													"code": 404,
													"_postman_previewlanguage": "text",
													"header": [],
													"cookie": [],
													"body": ""
												},
												{
													"name": "Unprocessable Entity",
													"originalRequest": {
														"method": "GET",
														"header": [
															{
																"key": "X-API-KEY",
																"value": "<API Key>",
																"description": "Added as a part of security scheme: apikey"
															}
														],
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/payment/status?paymentId=12345",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"payment",
																"status"
															],
															"query": [
																{
																	"key": "paymentId",
																	"value": "12345",
																	"description": "Payment ID (booking transaction ID)"
																}
															]
														}
													},
													"status": "Unprocessable Entity (WebDAV) (RFC 4918)",
													"code": 422,
													"_postman_previewlanguage": "text",
													"header": [],
													"cookie": [],
													"body": ""
												}
											]
										}
									]
								}
							]
						},
						{
							"name": "refund",
							"item": [
								{
									"name": "initiate",
									"item": [
										{
											"name": "Initiate a refund for a booking",
											"request": {
												"method": "POST",
												"header": [
													{
														"key": "Idempotency-Key",
														"value": "refund_abc123def456",
														"description": "Unique idempotency key for this refund request (prevents duplicate refunds)"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "Accept",
														"value": "application/json"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"paymentId\": {{payment_id}},\n  \"amountInCash\": 4000,\n  \"amountInCoins\": 50,\n  \"refundReference\": \"CANCEL_ORD123_001\",\n  \"coinsToRefund\": 250,\n  \"userId\": \"USER123\",\n  \"refundReason\": {\n    \"reason\": \"Flight cancellation by airline\",\n    \"cancellationType\": \"AIRLINE_INITIATED\",\n    \"ticketId\": \"TICKET789\"\n  },\n  \"metaInfo\": {\n    \"source\": \"CUSTOMER_REQUEST\",\n    \"channel\": \"WEB\"\n  }\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/refund/initiate",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"refund",
														"initiate"
													]
												},
												"description": "Initiates a full or partial refund for a completed booking. Follows the documented flow from OnArrival_ER_Diagram_And_Flows.md:\n1. Validates refund amounts (cannot exceed original amounts)\n2. Creates Refund Sub-Transaction (hidden from history) in tbl_rewards_sub_transactions\n3. Refunds coins: SPENT  BALANCE (via CoinsManagementService)\n4. Creates negative breakup entry in tbl_rewards_transaction_breakups (ledger)\n5. Refunds cash via Airpay (if cashRefund > 0)\n6. Updates BookingTransaction.meta.refundDetails[] array\n7. Updates BookingTransaction status (SUCCESS  REFUND_INITIATED or REFUNDED)\n\n**Partial Refunds:** Multiple partial refunds are supported per booking. Total refunds cannot exceed original amounts.\n\n**Idempotency:** \n- Requires `Idempotency-Key` header (stored in tbl_idempotency_keys with 24-hour expiry)\n- Same idempotency key returns cached response without processing\n- Secondary check via refundReference in BookingTransaction.meta\n"
											},
											"response": [
												{
													"name": "Refund initiated successfully",
													"originalRequest": {
														"method": "POST",
														"header": [
															{
																"key": "Idempotency-Key",
																"value": "refund_abc123def456",
																"description": "Unique idempotency key for this refund request (prevents duplicate refunds)"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "Accept",
																"value": "application/json"
															},
															{
																"key": "Authorization",
																"value": "Bearer <token>",
																"description": "Added as a part of security scheme: bearer"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"paymentId\": 12345,\n  \"amountInCash\": 4000,\n  \"amountInCoins\": 50,\n  \"refundReference\": \"CANCEL_ORD123_001\",\n  \"coinsToRefund\": 250,\n  \"userId\": \"USER123\",\n  \"refundReason\": {\n    \"reason\": \"Flight cancellation by airline\",\n    \"cancellationType\": \"AIRLINE_INITIATED\",\n    \"ticketId\": \"TICKET789\"\n  },\n  \"metaInfo\": {\n    \"source\": \"CUSTOMER_REQUEST\",\n    \"channel\": \"WEB\"\n  }\n}",
															"options": {
																"raw": {
																	"headerFamily": "json",
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/refund/initiate",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"refund",
																"initiate"
															]
														}
													},
													"status": "OK",
													"code": 200,
													"_postman_previewlanguage": "json",
													"header": [
														{
															"key": "Content-Type",
															"value": "application/json"
														}
													],
													"cookie": [],
													"body": "{\n  \"refundId\": \"CANCEL_ORD123_001\",\n  \"paymentId\": 12345,\n  \"refundAmount\": 4050,\n  \"cashRefunded\": 4000,\n  \"coinsRefunded\": 250,\n  \"status\": \"REFUND_INITIATED\",\n  \"refundGateway\": \"AIRPAY\",\n  \"rrn\": \"206101234567\",\n  \"utr\": \"CRED1704634200ORD789\",\n  \"initiatedAt\": \"2026-01-07T12:30:00.000Z\",\n  \"processedAt\": \"2026-01-07T12:30:00.000Z\",\n  \"completedAt\": \"2026-01-07T12:35:00.000Z\",\n  \"metadata\": {\n    \"source\": \"CUSTOMER_REQUEST\",\n    \"channel\": \"WEB\",\n    \"ticketId\": \"TICKET789\"\n  }\n}"
												},
												{
													"name": "Bad request - Validation errors in request body",
													"originalRequest": {
														"method": "POST",
														"header": [
															{
																"key": "Idempotency-Key",
																"value": "refund_abc123def456",
																"description": "Unique idempotency key for this refund request (prevents duplicate refunds)"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "Authorization",
																"value": "Bearer <token>",
																"description": "Added as a part of security scheme: bearer"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"paymentId\": 12345,\n  \"amountInCash\": 4000,\n  \"amountInCoins\": 50,\n  \"refundReference\": \"CANCEL_ORD123_001\",\n  \"coinsToRefund\": 250,\n  \"userId\": \"USER123\",\n  \"refundReason\": {\n    \"reason\": \"Flight cancellation by airline\",\n    \"cancellationType\": \"AIRLINE_INITIATED\",\n    \"ticketId\": \"TICKET789\"\n  },\n  \"metaInfo\": {\n    \"source\": \"CUSTOMER_REQUEST\",\n    \"channel\": \"WEB\"\n  }\n}",
															"options": {
																"raw": {
																	"headerFamily": "json",
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/refund/initiate",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"refund",
																"initiate"
															]
														}
													},
													"status": "Bad Request",
													"code": 400,
													"_postman_previewlanguage": "text",
													"header": [],
													"cookie": [],
													"body": ""
												},
												{
													"name": "Unauthorized - Valid OnArrival JWT required",
													"originalRequest": {
														"method": "POST",
														"header": [
															{
																"key": "Idempotency-Key",
																"value": "refund_abc123def456",
																"description": "Unique idempotency key for this refund request (prevents duplicate refunds)"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "Authorization",
																"value": "Bearer <token>",
																"description": "Added as a part of security scheme: bearer"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"paymentId\": 12345,\n  \"amountInCash\": 4000,\n  \"amountInCoins\": 50,\n  \"refundReference\": \"CANCEL_ORD123_001\",\n  \"coinsToRefund\": 250,\n  \"userId\": \"USER123\",\n  \"refundReason\": {\n    \"reason\": \"Flight cancellation by airline\",\n    \"cancellationType\": \"AIRLINE_INITIATED\",\n    \"ticketId\": \"TICKET789\"\n  },\n  \"metaInfo\": {\n    \"source\": \"CUSTOMER_REQUEST\",\n    \"channel\": \"WEB\"\n  }\n}",
															"options": {
																"raw": {
																	"headerFamily": "json",
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/refund/initiate",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"refund",
																"initiate"
															]
														}
													},
													"status": "Unauthorized",
													"code": 401,
													"_postman_previewlanguage": "text",
													"header": [],
													"cookie": [],
													"body": ""
												},
												{
													"name": "Unprocessable Entity - Business logic error (e.g., refund exceeds original amount, booking not successful)",
													"originalRequest": {
														"method": "POST",
														"header": [
															{
																"key": "Idempotency-Key",
																"value": "refund_abc123def456",
																"description": "Unique idempotency key for this refund request (prevents duplicate refunds)"
															},
															{
																"key": "Content-Type",
																"value": "application/json"
															},
															{
																"key": "Authorization",
																"value": "Bearer <token>",
																"description": "Added as a part of security scheme: bearer"
															}
														],
														"body": {
															"mode": "raw",
															"raw": "{\n  \"paymentId\": 12345,\n  \"amountInCash\": 4000,\n  \"amountInCoins\": 50,\n  \"refundReference\": \"CANCEL_ORD123_001\",\n  \"coinsToRefund\": 250,\n  \"userId\": \"USER123\",\n  \"refundReason\": {\n    \"reason\": \"Flight cancellation by airline\",\n    \"cancellationType\": \"AIRLINE_INITIATED\",\n    \"ticketId\": \"TICKET789\"\n  },\n  \"metaInfo\": {\n    \"source\": \"CUSTOMER_REQUEST\",\n    \"channel\": \"WEB\"\n  }\n}",
															"options": {
																"raw": {
																	"headerFamily": "json",
																	"language": "json"
																}
															}
														},
														"url": {
															"raw": "{{baseUrl}}/onarrival/v1/refund/initiate",
															"host": [
																"{{baseUrl}}"
															],
															"path": [
																"onarrival",
																"v1",
																"refund",
																"initiate"
															]
														}
													},
													"status": "Unprocessable Entity (WebDAV) (RFC 4918)",
													"code": 422,
													"_postman_previewlanguage": "text",
													"header": [],
													"cookie": [],
													"body": ""
												}
											]
										}
									]
								},
								{
									"name": "Get refund details by refundId",
									"request": {
										"auth": {
											"type": "apikey",
											"apikey": [
												{
													"key": "key",
													"value": "X-API-KEY",
													"type": "string"
												},
												{
													"key": "value",
													"value": "{{apiKey}}",
													"type": "string"
												},
												{
													"key": "in",
													"value": "header",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Accept",
												"value": "application/json"
											}
										],
										"url": {
											"raw": "{{baseUrl}}/onarrival/v1/refund?paymentId=12345&refundId=REFUND_ABC123",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"onarrival",
												"v1",
												"refund"
											],
											"query": [
												{
													"key": "paymentId",
													"value": "12345",
													"description": "The payment ID (booking transaction ID)"
												},
												{
													"key": "refundId",
													"value": "REFUND_ABC123",
													"description": "The unique refund reference ID"
												}
											]
										},
										"description": "Retrieves specific refund details for a booking transaction by refundId."
									},
									"response": [
										{
											"name": "Refund details retrieved successfully",
											"originalRequest": {
												"method": "GET",
												"header": [
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "X-API-KEY",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/refund?paymentId=12345&refundId=REFUND_ABC123",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"refund"
													],
													"query": [
														{
															"key": "paymentId",
															"value": "12345",
															"description": "The payment ID (booking transaction ID)"
														},
														{
															"key": "refundId",
															"value": "REFUND_ABC123",
															"description": "The unique refund reference ID"
														}
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n  \"refundId\": \"REFUND_ABC123\",\n  \"paymentId\": \"12345\",\n  \"status\": \"REFUNDED\",\n  \"refundAmount\": 4250,\n  \"cashRefunded\": 4000,\n  \"coinsRefunded\": 250,\n  \"coinsRefundedValue\": 250,\n  \"refundGateway\": \"AIRPAY\",\n  \"isPartialRefund\": false,\n  \"createdAt\": \"2024-01-15T10:30:00.000Z\",\n  \"refundedAt\": \"2024-01-15T10:35:00.000Z\",\n  \"completedAt\": \"2024-01-15T10:35:00.000Z\"\n}"
										},
										{
											"name": "Unauthorized - Valid OnArrival JWT required",
											"originalRequest": {
												"method": "GET",
												"header": [
													{
														"key": "X-API-KEY",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/refund?paymentId=12345&refundId=REFUND_ABC123",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"refund"
													],
													"query": [
														{
															"key": "paymentId",
															"value": "12345",
															"description": "The payment ID (booking transaction ID)"
														},
														{
															"key": "refundId",
															"value": "REFUND_ABC123",
															"description": "The unique refund reference ID"
														}
													]
												}
											},
											"status": "Unauthorized",
											"code": 401,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										},
										{
											"name": "Not found - Booking transaction ID does not exist",
											"originalRequest": {
												"method": "GET",
												"header": [
													{
														"key": "X-API-KEY",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/refund?paymentId=12345&refundId=REFUND_ABC123",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"refund"
													],
													"query": [
														{
															"key": "paymentId",
															"value": "12345",
															"description": "The payment ID (booking transaction ID)"
														},
														{
															"key": "refundId",
															"value": "REFUND_ABC123",
															"description": "The unique refund reference ID"
														}
													]
												}
											},
											"status": "Not Found",
											"code": 404,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										},
										{
											"name": "Unprocessable Entity",
											"originalRequest": {
												"method": "GET",
												"header": [
													{
														"key": "X-API-KEY",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/refund?paymentId=12345&refundId=REFUND_ABC123",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"refund"
													],
													"query": [
														{
															"key": "paymentId",
															"value": "12345",
															"description": "The payment ID (booking transaction ID)"
														},
														{
															"key": "refundId",
															"value": "REFUND_ABC123",
															"description": "The unique refund reference ID"
														}
													]
												}
											},
											"status": "Unprocessable Entity (WebDAV) (RFC 4918)",
											"code": 422,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										}
									]
								}
							]
						},
						{
							"name": "webhooks",
							"item": [
								{
									"name": "Receive webhook events from OnArrival",
									"request": {
										"auth": {
											"type": "apikey",
											"apikey": [
												{
													"key": "key",
													"value": "x-api-key",
													"type": "string"
												},
												{
													"key": "value",
													"value": "{{apiKey}}",
													"type": "string"
												},
												{
													"key": "in",
													"value": "header",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "your-webhook-api-key-here",
												"description": "OnArrival webhook API key for authentication"
											},
											{
												"key": "x-webhook-signature",
												"value": "abcdef1234567890...",
												"description": "HMAC-SHA256 signature of request body using webhook API key"
											},
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Accept",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"userId\": \"12345\",\n  \"eventType\": \"FLIGHT_SEARCHED\",\n  \"flightData\": {\n    \"id\": \"SEARCH_1234567890\",\n    \"flightSearchId\": \"SEARCH_1234567890\",\n    \"flightSearchInfo\": {\n      \"from\": {\n        \"code\": \"DEL\",\n        \"city\": \"Delhi\"\n      },\n      \"to\": {\n        \"code\": \"BOM\",\n        \"city\": \"Mumbai\"\n      },\n      \"tripType\": \"ONE_WAY\",\n      \"departureDate\": \"2024-02-15\",\n      \"travellerCount\": {\n        \"adult\": 1,\n        \"child\": 0,\n        \"infant\": 0\n      }\n    }\n  }\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/onarrival/v1/webhooks",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"onarrival",
												"v1",
												"webhooks"
											]
										},
										"description": "Webhook endpoint for receiving event notifications from OnArrival.\n\n**Authentication:**\n- Requires `x-api-key` header with valid OnArrival webhook API key\n- Requires `x-webhook-signature` header with HMAC-SHA256 signature of request body\n\n**Supported Event Types:**\n- `USER_LOADED_FLIGHT`: User loaded flight booking page (analytics)\n- `FLIGHT_SEARCHED`: User searched for flights (analytics)\n- `FLIGHT_SELECTED`: User selected a flight (analytics)\n- `FLIGHT_BOOKING_INITIATED`: Booking process started\n- `FLIGHT_BOOKING_SUCCESS`: Booking confirmed successfully\n- `FLIGHT_BOOKING_FAILED`: Booking failed\n- `FLIGHT_BOOKING_CANCELLED`: Booking cancelled\n- `FLIGHT_PAYMENT_INITIATED`: Payment process started\n- `FLIGHT_PAYMENT_COMPLETED`: Payment completed successfully\n- `FLIGHT_PAYMENT_FAILED`: Payment failed\n- `FLIGHT_PAYMENT_CANCELLED`: Payment cancelled by user\n- `FLIGHT_REFUND_INITIATED`: Refund process started\n- `FLIGHT_REFUND_SUCCESS`: Refund completed successfully\n- `FLIGHT_REFUND_FAILED`: Refund failed\n- `FLIGHT_RESCHEDULE_REQUESTED`: Flight reschedule requested\n- `FLIGHT_RESCHEDULED`: Flight rescheduled successfully\n\n**Payload Structure:**\nAll events follow a common envelope:\n- `userId`: User identifier\n- `eventType`: Event type from the list above\n- `flightData`: Event-specific data (null for USER_LOADED_FLIGHT)\n\n**Processing:**\n- Webhook is logged immediately in `tbl_on_arrival_webhook_logs`\n- Pushed to queue for asynchronous processing\n- Returns 200 OK immediately (webhook best practice)\n- Retry logic handles failed processing (max 5 attempts)\n\n**Idempotency:**\n- Same event can be safely received multiple times\n- Processing logic checks existing state before updates\n"
									},
									"response": [
										{
											"name": "Flight Searched Event",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "x-api-key",
														"value": "your-webhook-api-key-here",
														"description": "OnArrival webhook API key for authentication"
													},
													{
														"key": "x-webhook-signature",
														"value": "abcdef1234567890...",
														"description": "HMAC-SHA256 signature of request body using webhook API key"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "x-api-key",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"userId\": \"12345\",\n  \"eventType\": \"FLIGHT_SEARCHED\",\n  \"flightData\": {\n    \"id\": \"SEARCH_1234567890\",\n    \"flightSearchId\": \"SEARCH_1234567890\",\n    \"flightSearchInfo\": {\n      \"from\": {\n        \"code\": \"DEL\",\n        \"city\": \"Delhi\"\n      },\n      \"to\": {\n        \"code\": \"BOM\",\n        \"city\": \"Mumbai\"\n      },\n      \"tripType\": \"ONE_WAY\",\n      \"departureDate\": \"2024-02-15\",\n      \"travellerCount\": {\n        \"adult\": 1,\n        \"child\": 0,\n        \"infant\": 0\n      }\n    }\n  }\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/webhooks",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"webhooks"
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n  \"success\": true,\n  \"message\": \"Webhook received successfully\",\n  \"webhookLogId\": 789\n}"
										},
										{
											"name": "Payment Completed Event",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "x-api-key",
														"value": "your-webhook-api-key-here",
														"description": "OnArrival webhook API key for authentication"
													},
													{
														"key": "x-webhook-signature",
														"value": "abcdef1234567890...",
														"description": "HMAC-SHA256 signature of request body using webhook API key"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "x-api-key",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"userId\": \"12345\",\n  \"eventType\": \"FLIGHT_PAYMENT_COMPLETED\",\n  \"flightData\": {\n    \"id\": \"ORD_123456\",\n    \"bookingId\": \"BKG_789012\",\n    \"bookingStatus\": \"BOOKING_IN_PROGRESS\",\n    \"orderAmount\": {\n      \"currency\": \"INR\",\n      \"totalAmount\": 8000,\n      \"paymentSummary\": {\n        \"status\": \"PAYMENT_SUCCESSFUL\",\n        \"amountInCash\": 7500,\n        \"paymentId\": \"PAY_123\",\n        \"transactionId\": \"TXN_456\"\n      }\n    },\n    \"tripType\": \"ONE_WAY\",\n    \"international\": false\n  }\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/webhooks",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"webhooks"
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n  \"success\": true,\n  \"message\": \"Webhook received successfully\",\n  \"webhookLogId\": 789\n}"
										},
										{
											"name": "Booking Success Event",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "x-api-key",
														"value": "your-webhook-api-key-here",
														"description": "OnArrival webhook API key for authentication"
													},
													{
														"key": "x-webhook-signature",
														"value": "abcdef1234567890...",
														"description": "HMAC-SHA256 signature of request body using webhook API key"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "x-api-key",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"userId\": \"12345\",\n  \"eventType\": \"FLIGHT_BOOKING_SUCCESS\",\n  \"flightData\": {\n    \"id\": \"ORD_123456\",\n    \"bookingId\": \"BKG_789012\",\n    \"bookingStatus\": \"BOOKING_CONFIRMED\",\n    \"flights\": [\n      {\n        \"id\": \"FLT_001\",\n        \"departure\": \"DEL\",\n        \"arrival\": \"BOM\",\n        \"pnrNumber\": \"ABC123\"\n      }\n    ],\n    \"travellers\": [\n      {\n        \"firstName\": \"John\",\n        \"lastName\": \"Doe\",\n        \"type\": \"ADULT\",\n        \"gender\": \"MALE\"\n      }\n    ],\n    \"contactDetails\": {\n      \"firstName\": \"John\",\n      \"lastName\": \"Doe\",\n      \"email\": \"john@example.com\",\n      \"phoneNumber\": \"+919876543210\"\n    }\n  }\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/webhooks",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"webhooks"
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n  \"success\": true,\n  \"message\": \"Webhook received successfully\",\n  \"webhookLogId\": 789\n}"
										},
										{
											"name": "Refund Success Event",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "x-api-key",
														"value": "your-webhook-api-key-here",
														"description": "OnArrival webhook API key for authentication"
													},
													{
														"key": "x-webhook-signature",
														"value": "abcdef1234567890...",
														"description": "HMAC-SHA256 signature of request body using webhook API key"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "Accept",
														"value": "application/json"
													},
													{
														"key": "x-api-key",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"userId\": \"12345\",\n  \"eventType\": \"FLIGHT_REFUND_SUCCESS\",\n  \"flightData\": {\n    \"id\": \"ORD_123456\",\n    \"bookingStatus\": \"CANCELLED\",\n    \"orderAmount\": {\n      \"currency\": \"INR\",\n      \"totalAmount\": 8000,\n      \"paymentSummary\": {\n        \"amountRefunded\": 7200\n      }\n    }\n  }\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/webhooks",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"webhooks"
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n  \"success\": true,\n  \"message\": \"Webhook received successfully\",\n  \"webhookLogId\": 789\n}"
										},
										{
											"name": "Unauthorized - Invalid API key or signature",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "x-api-key",
														"value": "your-webhook-api-key-here",
														"description": "OnArrival webhook API key for authentication"
													},
													{
														"key": "x-webhook-signature",
														"value": "abcdef1234567890...",
														"description": "HMAC-SHA256 signature of request body using webhook API key"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "x-api-key",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"userId\": \"12345\",\n  \"eventType\": \"FLIGHT_SEARCHED\",\n  \"flightData\": {\n    \"id\": \"SEARCH_1234567890\",\n    \"flightSearchId\": \"SEARCH_1234567890\",\n    \"flightSearchInfo\": {\n      \"from\": {\n        \"code\": \"DEL\",\n        \"city\": \"Delhi\"\n      },\n      \"to\": {\n        \"code\": \"BOM\",\n        \"city\": \"Mumbai\"\n      },\n      \"tripType\": \"ONE_WAY\",\n      \"departureDate\": \"2024-02-15\",\n      \"travellerCount\": {\n        \"adult\": 1,\n        \"child\": 0,\n        \"infant\": 0\n      }\n    }\n  }\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/webhooks",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"webhooks"
													]
												}
											},
											"status": "Unauthorized",
											"code": 401,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										},
										{
											"name": "Unprocessable Entity - Invalid payload structure",
											"originalRequest": {
												"method": "POST",
												"header": [
													{
														"key": "x-api-key",
														"value": "your-webhook-api-key-here",
														"description": "OnArrival webhook API key for authentication"
													},
													{
														"key": "x-webhook-signature",
														"value": "abcdef1234567890...",
														"description": "HMAC-SHA256 signature of request body using webhook API key"
													},
													{
														"key": "Content-Type",
														"value": "application/json"
													},
													{
														"key": "x-api-key",
														"value": "<API Key>",
														"description": "Added as a part of security scheme: apikey"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n  \"userId\": \"12345\",\n  \"eventType\": \"FLIGHT_SEARCHED\",\n  \"flightData\": {\n    \"id\": \"SEARCH_1234567890\",\n    \"flightSearchId\": \"SEARCH_1234567890\",\n    \"flightSearchInfo\": {\n      \"from\": {\n        \"code\": \"DEL\",\n        \"city\": \"Delhi\"\n      },\n      \"to\": {\n        \"code\": \"BOM\",\n        \"city\": \"Mumbai\"\n      },\n      \"tripType\": \"ONE_WAY\",\n      \"departureDate\": \"2024-02-15\",\n      \"travellerCount\": {\n        \"adult\": 1,\n        \"child\": 0,\n        \"infant\": 0\n      }\n    }\n  }\n}",
													"options": {
														"raw": {
															"headerFamily": "json",
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "{{baseUrl}}/onarrival/v1/webhooks",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"onarrival",
														"v1",
														"webhooks"
													]
												}
											},
											"status": "Unprocessable Entity (WebDAV) (RFC 4918)",
											"code": 422,
											"_postman_previewlanguage": "text",
											"header": [],
											"cookie": [],
											"body": ""
										}
									]
								}
							]
						}
					]
				},
				{
					"name": "airpay-transaction-details",
					"item": [
						{
							"name": "Get Airpay transaction details",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bearerToken}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"airpayTransactionId\": 98765\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/customer/onarrival/v1/airpay-transaction-details",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"customer",
										"onarrival",
										"v1",
										"airpay-transaction-details"
									]
								},
								"description": "Retrieves Airpay transaction details by airpayTransactionId. This endpoint returns the payment data needed to invoke Airpay, including merchant ID, checksum, and transaction parameters.\n\n**Use Cases:**\n- App needs to re-invoke Airpay after app crash or user closed it\n- Resume a pending payment\n- Retrieve payment details for display\n\n**Important:** This endpoint only returns data for transactions that have `initiateTransactionData` in meta.\n"
							},
							"response": [
								{
									"name": "Transaction details retrieved successfully",
									"originalRequest": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Accept",
												"value": "application/json"
											},
											{
												"key": "Authorization",
												"value": "Bearer <token>",
												"description": "Added as a part of security scheme: bearer"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"airpayTransactionId\": 98765\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/customer/onarrival/v1/airpay-transaction-details",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"onarrival",
												"v1",
												"airpay-transaction-details"
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n  \"airpayTransactionId\": 98765,\n  \"orderId\": \"AIRPAY_ORD_123456\",\n  \"transactionStatus\": \"PENDING\",\n  \"amount\": 8000,\n  \"paymentData\": {\n    \"merchantId\": \"12345\",\n    \"data\": {\n      \"buyerEmail\": \"user@example.com\",\n      \"buyerPhone\": \"9876543210\",\n      \"buyerFirstName\": \"John\",\n      \"buyerLastName\": \"Doe\",\n      \"amount\": \"8000.00\",\n      \"orderid\": \"AIRPAY_ORD_123456\",\n      \"currency\": \"INR\",\n      \"isocurrency\": \"356\"\n    },\n    \"privateKey\": \"abc123def456...\",\n    \"checksum\": \"xyz789abc123...\",\n    \"protoDomain\": \"https://api.novio.in/airpay/callback\",\n    \"successUrl\": \"https://api.novio.in/airpay/callback\",\n    \"failureUrl\": \"https://api.novio.in/airpay/callback\"\n  }\n}"
								},
								{
									"name": "Bad request - Validation errors",
									"originalRequest": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Authorization",
												"value": "Bearer <token>",
												"description": "Added as a part of security scheme: bearer"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"airpayTransactionId\": 98765\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/customer/onarrival/v1/airpay-transaction-details",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"onarrival",
												"v1",
												"airpay-transaction-details"
											]
										}
									},
									"status": "Bad Request",
									"code": 400,
									"_postman_previewlanguage": "text",
									"header": [],
									"cookie": [],
									"body": ""
								},
								{
									"name": "Unauthorized - Valid OnArrival JWT required",
									"originalRequest": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Authorization",
												"value": "Bearer <token>",
												"description": "Added as a part of security scheme: bearer"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"airpayTransactionId\": 98765\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/customer/onarrival/v1/airpay-transaction-details",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"onarrival",
												"v1",
												"airpay-transaction-details"
											]
										}
									},
									"status": "Unauthorized",
									"code": 401,
									"_postman_previewlanguage": "text",
									"header": [],
									"cookie": [],
									"body": ""
								},
								{
									"name": "Airpay transaction not found",
									"originalRequest": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Authorization",
												"value": "Bearer <token>",
												"description": "Added as a part of security scheme: bearer"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"airpayTransactionId\": 98765\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/customer/onarrival/v1/airpay-transaction-details",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"onarrival",
												"v1",
												"airpay-transaction-details"
											]
										}
									},
									"status": "Not Found",
									"code": 404,
									"_postman_previewlanguage": "text",
									"header": [],
									"cookie": [],
									"body": ""
								},
								{
									"name": "Payment data not available for this transaction",
									"originalRequest": {
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Accept",
												"value": "application/json"
											},
											{
												"key": "Authorization",
												"value": "Bearer <token>",
												"description": "Added as a part of security scheme: bearer"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"airpayTransactionId\": 98765\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/customer/onarrival/v1/airpay-transaction-details",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"customer",
												"onarrival",
												"v1",
												"airpay-transaction-details"
											]
										}
									},
									"status": "Unprocessable Entity (WebDAV) (RFC 4918)",
									"code": 422,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n  \"success\": false,\n  \"message\": \"Payment data not found for this transaction\"\n}"
								}
							]
						}
					]
				}
			],
			"auth": {
				"type": "bearer",
				"bearer": [
					{
						"key": "token",
						"value": "{{jwt_token}}",
						"type": "string"
					}
				]
			},
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							""
						]
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "d9-api.novio.co.in"
		},
		{
			"key": "otp",
			"value": 2944
		},
		{
			"key": "mobile",
			"value": "9002858805"
		},
		{
			"key": "user_token",
			"value": "MjIxMw.2nbXbxs23-rCpsBZHj_67hLqACgJC8_1KdG_6GH2KjnuunV0ycah_Lfjm-_e"
		},
		{
			"key": "jwt_token",
			"value": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxNzY3ODUxMDM1NzkzMjc5IiwiaXNzIjoiaHR0cHM6Ly93d3cubm92aW8uaW4iLCJvcmdhbml6YXRpb25JZCI6IjNlZTFiYmE3LWY2MWEtNGViNS05MDY3LTdiOGFjNGQzZWQxYSIsIm9yZ2FuaXphdGlvbkNvZGUiOiJDUkVESUxJTyIsImV4cCI6MTc2ODAzNzkzNywiaWF0IjoxNzY3OTUxNTM3fQ.JtsF5kLZ5ZAWaEKu7qaNuz99XpvAla-jakQdAGoMSqMum6-dpG4W2EIrEntAPbWFg8vsmkIp-ckHEapjhvBz-Q9rUN3r6bI5_LBfxy1ZUIcpyDmLbEvzFTRAkxbshgi7JzVX6iCFfH3bkrMR38k_URhU-dmURjdOeg56bd0BAwH_n5gFXp6-CF-wXIabga4DOnI7bd1RbdMX3QugVe9KvvwO9hgT3axZItG4kCM7ODu9O7oY8X48tGBrsJU3v_C6Fjb1VTaf9x1C0aZOW-M9BMhZFFQA184-3vv4gdVDPVBOsUI0so4mp8sW-ix5pLQsUOQqwFNhYD_pIQOz53ST0Q"
		},
		{
			"key": "novio_code",
			"value": "1767851035793279"
		},
		{
			"key": "paymentId",
			"value": 1767876905198463
		},
		{
			"key": "gatewayOrderId",
			"value": "N4bNo5DQ588AK6DO"
		},
		{
			"key": "gatewayTransactionId",
			"value": 1767876905231173
		},
		{
			"key": "paymentOrderId",
			"value": "ORD123456789"
		},
		{
			"key": "paymentTransactionId",
			"value": "TXN987654321"
		},
		{
			"key": "paymentCreatedAt",
			"value": "2026-01-08T18:25:05.231+05:30"
		},
		{
			"key": "apiKey",
			"value": "4b07ae8e8b2171841ec87994e2a6afe9"
		},
		{
			"key": "payment_id",
			"value": 1767951538340698
		}
	]
}